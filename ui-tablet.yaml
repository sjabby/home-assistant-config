
##########################################################################
#                                                                        #
#                              * SETTINGS *                              #
#                                                                        #
##########################################################################

custom_header:
  kiosk_mode: true
  exceptions:
    - conditions:
        user_agent: Mobile
      config:
        kiosk_mode: false

preload_cards:
  [map, iframe]
preload_rows:
  [input-select-entity]

anchors:
  ⚓₁: &title
    entity: sensor.placeholder
    tap_action:
      action: none
    hold_action:
      action: none
    type: state-label
  ⚓₂: &title-style
    color: '#bcbebf'
    font-family: SF Text
    font-size: 2.4vw
    font-weight: 500
    max-width: 1px
    cursor: default

button_card_templates:
  light:
    aspect_ratio: 1/1
    show_state: true
    show_icon: false
    state: &button_state
      - value: 'on'
        styles:
          card: [background-color: 'rgba(255, 255, 255, 0.8)']
          name: [color: 'rgba(0, 0, 0, 0.6)']
          state: [color: 'rgba(0, 0, 0, 0.6)']
    custom_fields:
      info: >
        [[[ if (entity.state === 'on' && entity.attributes.brightness) {
        const brightness = Math.round(entity.attributes.brightness / 2.54);
        const radius = 20.5; const circumference = radius * 2 * Math.PI; 
        return `<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="${radius}" stroke="#b2b2b2" stroke-width="1.5" fill="none" style="
        transform: rotate(-90deg); transform-origin: 50% 50%; stroke-dasharray: ${circumference}; stroke-dashoffset: ${circumference - brightness / 100 * circumference};" />
        <text x="50%" y="54%" fill="#8d8e90" font-size="14" text-anchor="middle" alignment-baseline="middle">${brightness}<tspan font-size="10">%</tspan></text></svg>`; } ]]]
    styles:
      name: &button_styles_name
        [top: 57.7%, left: 11%, position: absolute, line-height: 2vw]
      state: &button_styles_state
        [top: 74%, left: 11%, position: absolute, line-height: 2vw]
      custom_fields:
        info: &circle_pos
          [top: 8.5%, left: 56.2%, width: 3.5vw, position: absolute, letter-spacing: 0.03vw]
      card: &button_styles_card
        [font-family: Sf Display, letter-spacing: 0.05vw, text-rendering: optimizeLegibility, font-weight: 400, color: 'rgba(255, 255, 255, 0.3)', font-size: 1.34vw, 
        background-color: 'rgba(115, 115, 115, 0.2)', border-radius: 0.8vw, box-shadow: none, transition: none]
    tap_action:
      ui_sound: &ui_sound |
        [[[ if (entity.state === 'off' && states['switch.fullykiosk_screensaver'].state === 'off') {
        hass.callService('media_player', 'play_media', {entity_id: 'media_player.fullykiosk', media_content_id: '/local/sound/on.m4a', media_content_type: 'music'}); }
        else if (entity.state === 'on' && states['switch.fullykiosk_screensaver'].state === 'off') {
        hass.callService('media_player', 'play_media', {entity_id: 'media_player.fullykiosk', media_content_id: '/local/sound/off.m4a', media_content_type: 'music'}); } ]]]
      action: toggle
      haptic: light
    hold_action:
      action: call-service
      service: browser_mod.popup
      service_data:
        title: Lukk
        deviceID: this
        style:
          --ha-card-border-radius: 1em
          --more-info-header-color: rgba(255,255,255,0.6)
          background: none
          box-shadow: none
        card:
          type: vertical-stack
          cards:
            - type: entities
              title: '[[[ return entity.attributes.friendly_name ]]]'
              style: &popup_style |
                ha-card {
                  animation: pop-in 0.8s cubic-bezier(0.16, 1, 0.3, 1) both; transform-origin: center;
                  box-shadow: none; border-radius: 1em; padding: 0.3em 1.25em 0.4em 0.5em; 
                  background: linear-gradient(180deg, rgba(48,52,52,1) 0%, rgba(48,52,52,1) 4.8em, rgba(34,38,39,1) 4.8em, rgba(34,38,39,1) 100%); }
                .card-header {
                  margin: -0.4em 0 1.4em 0.4em; font-family: sf text; letter-spacing: 0.005em; font-size: 1.5em;}
                @keyframes pop-in {
                  0% { transform: scale(0.6); opacity: 0; } 20% { opacity: 0; } 100% { transform: scale(1); opacity: 0.9; }}
              show_header_toggle: false
              entities:
                - type: custom:light-popup-card
                  entity: '[[[ return entity.entity_id ]]]'
                  icon: none
                  fullscreen: false
                  brightnessWidth: 130px
                  brightnessHeight: 360px
                  borderRadius: 1.7em
                  sliderColor: '#c7c7c7'
                  sliderTrackColor: rgba(25, 25, 25, 0.9)
                  actionSize: 4.5em
                  actionsInARow: 2
                  style: |
                    #popup { 
                      margin: -2.4em 0 1.4em 0; }
                    #popup > div.range-holder > input[type=range] {
                      cursor: grab; }
                    #brightnessValue {
                      color: rgba(255, 255, 255, 0.8); margin: -1em 0 0 0; font-size: 2em; font-weight: 400; 
                      position: absolute; z-index: 100; font-family: SF Display; letter-spacing: 0.02em; pointer-events: none; 
                      mix-blend-mode: difference; text-align:center; width: 3.4em; height: 3.4em; }
                    #popup > div.range-holder > input[type=range]::-webkit-slider-thumb {
                      border: 0; eight: 0; width: 0; cursor: grabbing; }
                    #popup > div.action-holder > div > div {
                      margin: 0.8em 0.5em -0.8em 0.5em; }
                    #popup > div.action-holder > div:nth-child(2) > div:nth-child(2) > span {
                      background: radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(255,255,255,0) 80%), 
                      conic-gradient(rgb(120,39,230), rgb(230,34,231), rgb(228,5,136), rgb(228,25,25), rgb(229,105,30), rgb(232,226,46), 
                      rgb(125,230,41), rgb(52,232,40), rgb(51,231,92), rgb(52,232,224),rgb(32,125,229), rgb(18,39,229), rgb(120,39,230));
                      border-width: 2px; border-color: #e6e6e6; --size: 4.4em !important; }
                  actions:
                    - service: light.turn_on
                      service_data:
                        entity_id: '[[[ return entity.entity_id ]]]'
                        color_temp: 153
                      color: "#d8d9e1"
                    - service: light.turn_on
                      service_data:
                        entity_id: '[[[ return entity.entity_id ]]]'
                        color_temp: 326
                      color: "#d5b08d"
                    - service: light.turn_on
                      service_data:
                        entity_id: '[[[ return entity.entity_id ]]]'
                        color_temp: 500
                      color: "#ce944b"
                    - service: browser_mod.popup
                      service_data:
                        title: Lukk
                        deviceID: this
                        style:
                          --ha-card-border-radius: 1em
                          --more-info-header-color: rgba(255,255,255,0.6)
                          background: none
                          box-shadow: none
                        card:
                          type: entities
                          title: Fargeinnstillinger
                          style: *popup_style
                          show_header_toggle: false
                          entities:
                            - entity: '[[[ return entity.entity_id ]]]'
                              secondary_info: last-changed
                            - type: custom:light-entity-card
                              entity: '[[[ return entity.entity_id ]]]'
                              style:
                                .: |
                                  ha-card {
                                    background: none; box-shadow: none; margin: -0.5em -1em -0.5em -0.7em; }
                                  ha-card > div.light-entity-card-sliders.ha-slider-full-width { 
                                    margin-bottom: 0.75em; }
                                  ha-card > div.light-entity-card-sliders.ha-slider-full-width > div > ha-icon {
                                    margin: auto; width: 34px; height: 34px; cursor: default; 
                                    padding-right: 0.49em; color: var(--paper-item-icon-color);}
                                  ha-card > div.light-entity-card-sliders.ha-slider-full-width > div > div {
                                    margin: auto; padding: 0 1.4em 0 1em; max-width: 1em; cursor: default;}
                                'ha-card > div.light-entity-card-sliders.ha-slider-full-width > div > ha-slider':
                                  $: |
                                    #sliderContainer { 
                                      --calculated-paper-slider-height: var(--paper-slider-height, 5px); }
                              brightness: false
                              color_temp: true
                              full_width_sliders: true
                              header: false
                              show_slider_percent: true
                              smooth_color_wheel: true

  switch:
    aspect_ratio: 1/1
    show_state: true
    show_icon: false
    state: *button_state
    styles:
      name: *button_styles_name
      state: *button_styles_state
      card: *button_styles_card
      custom_fields:
        loading:
          [filter: "[[[ return entity.state === 'off' ? 'invert(1)' : 'none'; ]]]", 
           top: 3%, left: 60%, width: 3.7vw, position: absolute, opacity: 0.6]
    tap_action:
      ui_sound: *ui_sound
      haptic: light

  icon_action:
    color: '#9da0a2'
    styles:
      card:
        [background: '#FFFFFF10', border-radius: 0.6em, box-shadow: none, 
        transition: none, width: 4em, height: 3.7em]

  name_action:
    styles:
      name:
        [display: flex, align-items: center, justify-content: center, margin-top: 0.5px]
      card:
        [background: '#FFFFFF10', color: '#9da0a2', border-radius: 0.6em, box-shadow: none, 
        transition: none, width: 100%, padding: 1em 1.4em 1em 1.2em, font-size: 1.06em, 
        font-weight: 500, letter-spacing: 0.015em]
    style: '#name > ha-icon {width: 1.4em; margin-right: 0.3em; }'

  media:
    aspect_ratio: 1/1
    show_state: true
    show_icon: false
    state_display: >
      [[[ if (entity.attributes.media_title === 'Nothing playing' || entity.attributes.media_title === 'No title' && entity.state === 'paused' ) { return 'Ingenting spilles'; }
      if (entity.attributes.media_title === 'No title' && entity.state === 'playing') { return 'Ingen tittel'; }
      else { return entity.attributes.media_title; } ]]]
    custom_fields:
      media_image: >
        <svg viewBox="0 0 50 50" />
      blur: >
        [[[ if (entity.attributes.entity_picture != null) {
        return '<svg viewBox="0 0 50 50" />'; } ]]]
      overlay: >
        [[[ if (entity.state != 'off' && entity.state != 'idle' && entity.state != 'standby' && entity.state != 'unavailable') {
        return '<svg viewBox="0 0 50 50" />'; } ]]]
      play_pause: >
        [[[ const style = `<style>.scale-up { animation: scale-up 0.3s; cubic-bezier(.05,.5,.3,1) 1; transform-origin: center center; }
        @keyframes scale-up { 0% { opacity: 0; transform: scale(0); } 100% { opacity: 1; transform: scale(1); } }</style>`;
        if (entity.state === 'playing') { return `<svg viewBox="0 0 166 166">${style}<path class="scale-up" d="M0 0h59.9v166H0zm106.1 0H166v166h-59.9z"/></svg>`; }
        if (entity.state === 'paused') { return `<svg viewBox="0 0 166 166">${style}<path class="scale-up" d="M0 0l166 83L0 166z"/></svg>`; } ]]]
    tap_action: &media_tap_action
      sound: >
        [[[ if (states['switch.fullykiosk_screensaver'].state === 'off') {
        if (entity.state != 'off' || entity.state != 'idle' || entity.state != 'standby')
        hass.callService('media_player', 'play_media', {entity_id: 'media_player.fullykiosk', media_content_id: '/local/sound/popup.m4a', media_content_type: 'music'}); } ]]]
      action: >
        [[[ if (entity.state === 'off' || entity.state === 'idle' || entity.state === 'standby') {
        return 'none'; } else { return 'call-service'; } ]]]
      service: media_player.media_play_pause
      service_data:
        entity_id: '[[[ return entity.entity_id ]]]'
      haptic: light
    styles:
      custom_fields:
        media_image:
          [background-image:
          "[[[ return entity.attributes.entity_picture == null ? 'linear-gradient(0deg, rgba(115, 115, 115, 0.2) 0%, rgba(115, 115, 115, 0.2) 100%)' 
          : 'linear-gradient(0deg, rgba(13,17,19,0.9) 0%, rgba(13,17,19,0) 50%), url(' + entity.attributes.entity_picture + ')'; ]]]", 
          background-size: cover, top: 0%, left: 0%, width: 100%, position: absolute]
        blur:
          [background-image:
          "[[[ return entity.attributes.entity_picture == null ? 'none' : 'url(' + entity.attributes.entity_picture + ')'; ]]]", 
          background-size: cover, top: 0%, left: 0%, width: 100%, filter: blur(4px), clip-path: inset(16vw 0 0 0), position: absolute]
        overlay:
          [background:
          "[[[ return entity.attributes.entity_picture == null ? 'rgba(255, 255, 255, 0.8)' : 'rgba(0, 0, 0, 0.4)'; ]]]", 
          background-size: cover, z-index: 0, top: 16vw, left: 0%, width: 100%, opacity: 1, position: absolute]
        play_pause:
          [filter: 
          "[[[ return entity.attributes.entity_picture == null ? 'none' : 'drop-shadow(0 0 1.3vw rgba(0,0,0,0.7))'; ]]]", 
          fill: '#dedede', top: 0, right: 0, bottom: 0, left: 0, margin: auto, width: 21%, height: 21%, position: absolute]
        icon:
          [fill:
          "[[[ if (entity.state === 'off' || entity.state === 'idle' || entity.state === 'standby' || entity.state === 'unavailable') return '#9da0a2'; 
          else return 'rgba(255, 255, 255, 0.8)'; ]]]", 
          top: 5.35%, left: 5.35%, width: 2.95vw, position: absolute]
      name:
        [top: 79.8%, left: 5.3%, position: absolute, line-height: 2vw, z-index: 10]
      state:
        [top: 87.5%, left: 5.3%, position: absolute, line-height: 2vw, z-index: 10, 
        white-space: nowrap, overflow: hidden, text-overflow: ellipsis, max-width: 90%]
      card: 
        [<<: *button_styles_card, background-color: none, 
        color: &media_font_color "[[[ if (entity.state === 'off' || entity.state === 'idle' || entity.state === 'standby' || entity.state === 'unavailable') { return 'rgba(255, 255, 255, 0.3)'; }
        if ((entity.state != 'off' && entity.state != 'idle' && entity.state != 'standby') && (entity.attributes.entity_picture == null)) {
        return 'rgba(0, 0, 0, 0.6)'; } else { return '#efefef'; } ]]]", 
        text-shadow: &media_text_shadow "[[[ if (entity.attributes.entity_picture == null) return 'none'; 
        else return '1px 1px 5px rgba(18, 22, 23, 0.9)' ; ]]]"]

  media_small:
    aspect_ratio: 1/1
    show_state: true
    show_icon: false
    tap_action: *media_tap_action
    styles:
      custom_fields:
        icon:
          [opacity: "[[[ return entity.attributes.entity_picture == null ? 1 : 0; ]]]", 
          top: 11.5%, left: 11.5%, width: 2.9vw, position: absolute, fill: '#9da0a2']
      name: *button_styles_name
      state: *button_styles_state
      card:
        [<<: *button_styles_card, color: *media_font_color, text-shadow: *media_text_shadow, 
        background-color: none, background-size: cover,
        background-image: 
        "[[[ if (entity.state === 'off' || entity.state === 'idle' || entity.state === 'standby' || entity.state === 'unavailable') {
        return 'linear-gradient(0deg, rgba(115, 115, 115, 0.2) 0%, rgba(115, 115, 115, 0.2) 100%)'; }
        if ((entity.state != 'off' && entity.state != 'idle' && entity.state != 'standby') && (entity.attributes.entity_picture == null)) {
        return 'linear-gradient(0deg, rgba(255, 255, 255, 0.8) 0%, rgba(255, 255, 255, 0.8) 100%)'; }
        else { return 'linear-gradient(0deg, rgba(0,0,0,.8) 0%, rgba(0,0,0,0) 100%), url(' + entity.attributes.entity_picture + ')'; } ]]]"]


title: Hjemme
views:
  - panel: true
    path: tablet
    theme: tablet
    cards:
      - type: picture-elements
        image: /local/gfx/background.png
        style:
          .: |
            /* Global */
            #root > hui-icon-element {color: rgba(255, 255, 255, 0.1) !important; transition: 0.4s;}
            #root > hui-icon-element:hover {color: rgba(255, 255, 255, 0.25) !important; transition: none;}
            #root > hui-icon-element:active {color: rgba(255, 255, 255, 0.35) !important; transition: none;}
          "#root > hui-image":
            $: |
              #image {pointer-events: none;}
          "#root > hui-markdown-card, #root > hui-element > hui-markdown-card":
            $: |
              ha-card > ha-markdown {padding: 0 !important;}
              ha-card > ha-markdown > p > font > ha-icon {vertical-align: 3%; opacity: 0.6;}
              ha-card > ha-markdown > p > span {font-family: SF Text; font-size: 5vw; 
              font-weight: 200; margin-left: -0.3vw; letter-spacing: -0.05vw;}
          "#root > hui-state-label-element":
            $: |
              div {padding: 0 !important;}
          "#root > hui-conditional-element:nth-child(11) > button-card":
            $: |
              #card { background-color: #202a2f90; }
              #card:hover, #card:active { filter: brightness(140%); transition: none; }
        elements:

          #################################################
          #                                               #
          #                   COVID-19                    #
          #                                               #
          #################################################

          - type: custom:hui-markdown-card
            style:
              top: 93.5%
              left: 70.2%
              width: 90vw
              height: 1px
              --mdc-icon-size: 1.2vw
              --ha-card-background: none
              --ha-card-box-shadow: none
              --primary-text-color: '#6a7377'
              font-family: SF Display
              font-size: 1.15vw
              font-weight: 400
              letter-spacing: 0.06vw
              line-height: 2.05vw
              opacity: 0.5
            content: >
              {% if is_state('sensor.norway_coronavirus_current', 
              'unavailable') %} {% else %}
              <font color='#6a7377'>
              <b><ha-icon icon="custom:corona-virus"></ha-icon> <b>Coronavirus</b>
              ‍  ‍  ‍   ‍  ‍  ‍ <font color='#2f3436'>|‍</font>  ‍  ‍  ‍   ‍  ‍  ‍ 
              <b><ha-icon icon="mdi:emoticon-sad"></ha-icon> 
              {{ states('sensor.norway_coronavirus_current') }}</b> smittede
              ‍  ‍  ‍   ‍  ‍  ‍ <font color='#2f3436'>|‍</font>  ‍  ‍  ‍   ‍  ‍  ‍ 
              <ha-icon icon="mdi:chart-bar"></ha-icon> 
              <b>{{ ((states('sensor.norway_coronavirus_confirmed') 
              | int / 5414135 ) * 100) | round(2) }}%</b> av Norge </font>
              ‍  ‍  ‍   ‍  ‍  ‍ <font color='#2f3436'>|‍</font>  ‍  ‍  ‍   ‍  ‍  ‍ 
              <b><ha-icon icon="mdi:emoticon-happy"></ha-icon> 
              {{ states('sensor.norway_coronavirus_recovered') }}</b> friskmeldt
              ‍  ‍  ‍   ‍  ‍  ‍ <font color='#2f3436'>|‍</font>  ‍  ‍  ‍   ‍  ‍  ‍ 
              <b><ha-icon icon="mdi:grave-stone"></ha-icon> 
              {{ states('sensor.norway_coronavirus_deaths') }}</b> døde
              {% endif %}

          ##########################################################################
          #                                                                        #
          #                              * SIDEBAR *                               #
          #                                                                        #
          ##########################################################################

          - type: image
            image: local/gfx/sidebar.png
            tap_action:
              action: none
            hold_action:
              action: none
            style:
              top: 50%
              left: 10.6%
              width: 21.5%
              pointer-events: none
              border-right: 1.5px solid rgba(58,69,73,0.2)

          #################################################
          #                                               #
          #                     CLOCK                     #
          #                                               #
          #################################################

          - type: state-label
            entity: sensor.time
            tap_action:
              action: none
            hold_action:
              action: none
            style:
              top: 10.8%
              left: 2.8%
              color: rgba(255, 255, 255, 0.7)
              font-family: SF Text
              font-size: 5.41vw
              font-weight: 200
              letter-spacing: -0.05vw
              max-width: 1px
              cursor: default

          #################################################
          #                                               #
          #                   MARKDOWN                    #
          #                                               #
          #################################################

          - type: custom:hui-element
            card_type: markdown
            style:
              top: 16%
              left: 11%
              width: 17.5vw
              height: 1px
              --ha-card-background: none
              --ha-card-box-shadow: none
              --primary-text-color: rgba(255, 255, 255, 0.9)
              font-family: SF Display
              font-size: 1.6vw
              font-weight: 300
              letter-spacing: 0.06vw
              line-height: 2.05vw
              opacity: 0.75
            content: >
              <font color='#6a7377'><b>{{ states('sensor.dag') }}</b><br>
              <b>{{ states('sensor.dato') }}</b> </font><br> 


              <b>{{ states('sensor.sidebar_greeting') }}</b>


              <b>{{ states('sensor.sidebar_active') }}</b>


              <font color='#6a7377'>
              <b>{{ states('sensor.sidebar_vacuum') }}</b>


              {{ states('sensor.sidebar_weather') }}


              {{ states('sensor.sidebar_buss') }}


              {{ states('sensor.tvatta_countdown') }}

              {% if is_state('binary_sensor.check_plex', 'off') %}
              {{'\u26A0\uFE0F'}} Plex är nere...{% endif %}


              {% if is_state('binary_sensor.nas_internet_access', 'off') %}
              {{'\u26A0\uFE0F'}} Kontrollera NAS internetåtkomst{% endif %}
              </font>

          #################################################
          #                                               #
          #                 LAUNDRY TIMER                 #
          #                                               #
          #################################################

          # - type: conditional
          #   conditions:
          #     - entity: input_boolean.laundry_timer_visibility
          #       state: 'on'
          #   elements:
          #     - type: custom:button-card
          #       entity: timer.laundry
          #       show_icon: false
          #       show_name: false
          #       show_state: true
          #       tap_action:
          #         services: |
          #           [[[ hass.callService('timer', 'cancel', {entity_id: 'timer.laundry'});
          #           hass.callService('timer', 'start', {entity_id: 'timer.laundry'}); ]]]
          #       hold_action:
          #         services: |
          #           [[[ hass.callService('timer', 'cancel', {entity_id: 'timer.laundry'});
          #           hass.callService('input_boolean', 'turn_off', {entity_id: 'input_boolean.laundry_timer_visibility'}); ]]]
          #       styles:
          #         card:
          #           [background: '#202a2f30', border-radius: 0.7vw, box-shadow: none, border: '0.1vw solid #292c2e']
          #         state:
          #           [font-size: 2.5vw, font-weight: 500, letter-spacing: 0.09vw, opacity: 0.65, padding: 0.5vw 1vw 0.5vw 1vw]
          #       style:
          #         top: 78%
          #         left: 10.8%
          #         font-size: 1.6vw

          #################################################
          #                                               #
          #                 VACUUM BUTTON                 #
          #                                               #
          #################################################

          - type: icon
            icon: custom:roborock-vacuum
            title: Støvsuger
            style:
              top: 87.41%
              left: 4.8%
              color: rgba(255, 255, 255, 0.10)
              padding: 0.8vw
              --mdc-icon-size: 4vw
            tap_action: !include popup/sidebar_vacuum.yaml

          #################################################
          #                                               #
          #                  INFO BUTTON                  #
          #                                               #
          #################################################

          - type: icon
            icon: mdi:information-outline
            title: Information
            style:
              top: 87.41%
              left: 10.7%
              color: rgba(255, 255, 255, 0.10)
              padding: 0.8vw
              --mdc-icon-size: 4vw
            tap_action: !include popup/sidebar_information.yaml

          - type: conditional
            conditions:
              - entity: binary_sensor.updater
                state_not: 'off'
            elements:
              - type: image
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'%3E%3Ccircle cx='25' cy='25' r='20.3' fill='%23ac2e2e' /%3E%3Cpath d='M24.4 18.3h0L19 21.9v-3.4l5.3-3.7H28v20.4h-3.6V18.3z' fill='%23bcbebf' /%3E%3C/svg%3E"
                style:
                  top: 85%
                  left: 12.2%
                  width: 1.7%
                tap_action: !include popup/sidebar_information.yaml

          #################################################
          #                                               #
          #                 SCENES BUTTON                 #
          #                                               #
          #################################################

          - type: icon
            icon: mdi:home-heart
            title: Scener
            style:
              top: 87.55%
              left: 16.55%
              color: rgba(255, 255, 255, 0.10)
              padding: 0.8vw
              --mdc-icon-size: 4.6vw
            tap_action: !include popup/sidebar_scenarier.yaml

          #################################################
          #                                               #
          #                  HACS SENSOR                  #
          #                                               #
          #################################################

          - type: conditional
            conditions:
              - entity: sensor.hacs
                state_not: '0'
              - entity: sensor.hacs
                state_not: unknown
            elements:
              - type: custom:button-card
                style:
                  top: 95%
                  left: 10.45%
                name: >
                  [[[ if (parseInt(states['sensor.hacs'].state) === 1) {
                  return states['sensor.hacs'].state + ' oppdatering tilgjengelig'; }
                  else { return states['sensor.hacs'].state + ' oppdateringer tilgjengelig'; } ]]]
                styles:
                  name:
                    [letter-spacing: 0.06vw, font-family: SF Display, font-weight: 500, 
                    font-size: 1.15vw, color: '#6a7377', padding: 0.4vw 1.2vw 0.4vw 1.2vw]
                  card:
                    [background: '#202a2f90', border-radius: 0.7vw, opacity: 0.5]
                tap_action:
                  action: call-service
                  service: browser_mod.popup
                  service_data:
                    title: Lukk
                    deviceID: this
                    style:
                      background: none
                      box-shadow: none
                      width: 75em
                    card:
                      type: custom:hui-element
                      card_type: iframe
                      url: !secret hacs_url
                      aspect_ratio: 60%
                      style: 'ha-card { border-radius: 1em;}'

          ##########################################################################
          #                                                                        #
          #                             * VARDAGSRUM *                             #
          #                                                                        #
          ##########################################################################

          - prefix: Stue
            <<: *title
            style:
              top: 9.15%
              left: 24.85%
              <<: *title-style

          #################################################
          #                                               #
          #                   BELYSNING                   #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: light.stue
            style:
              top: 20.35%
              left: 30.31%
              width: 10%
            custom_fields:
              icon_hue: &icon_hue >
                <svg viewBox="0 0 50 50"><path d="M27.4 47.3h-4.9s-.7.1-.7.8.4.9.7.9h4.9c.3 0 .7-.1.7-.9s-.7-.8-.7-.8zm3.3-2.9H19.3s-.8 0-.8.8.6.9.8.9h11.5c.2 0 .8-.1.8-.9-.1-.8-.9-.8-.9-.8zm0-3H19.3s-.8 0-.8.8.6.9.8.9h11.5c.2 0 .8-.1.8-.9-.1-.8-.9-.8-.9-.8zm0-2.9H19.3s-.8 0-.8.8.6.9.8.9h11.5c.2 0 .8-.1.8-.9s-.9-.8-.9-.8zm5.2-23.2c-3.3-5.3-7-5.6-10.9-5.6-3.8 0-8.4.4-10.9 5.6-.1.1-.1.3.1.7.4.8 3.3 7.2 3.2 18.8 0 1.1-.1 1.6 0 1.7 0 .1 0 .7 1.1.7h13c1 0 1-.5 1.1-.7v-1.7c-.1-11.6 2.8-18 3.2-18.8.1-.4.1-.5.1-.7" fill="#9da0a2"/><path d="M14.1 15.3c3.4-.3 7-.4 10.9-.4 3.8 0 7.5.2 10.9.4.4-.4.7-.8.9-1.1C39 8.5 38.9 6.5 38.9 6c-.2-4.4-8.4-5-12.1-5h0-3.4c-3.7 0-12 .5-12.1 5 0 .5-.1 2.5 2.1 8.2 0 .3.3.8.7 1.1z" fill="var(--button-card-light-color-no-temperature)"/></svg>
            styles: &icon_hue_styles
              custom_fields:
                icon_hue:
                  [top: 11%, left: 4.5%, width: 3.05vw, position: absolute]
            template: light

          #################################################
          #                                               #
          #                   SKRIVBORD                   #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: light.livingroom
            name: Tv & Vindu
            style:
              top: 20.35%
              left: 41.31%
              width: 10%
            custom_fields:
              icon_shade: >
                <svg viewBox="0 0 50 50"><path d="M26.4 25.6c.6-.3 1.1-.7 1.1-1.3L25 17.9l-2.5 6.4c0 .7.6 1.1 1.1 1.3v20.8h-5.5v2.7h13.7v-2.7h-5.5V25.6z" fill="#9da0a2"/><path d="M24.6.9l-9.4.5c-.6.1-1.9 0-2.5 2.1s-2.4 9.1-4 16.9c-.2.7-.5 2-.5 2.3s-.4 1.6.9 1.6c.8.1 7.4.3 15.9.3 8.6 0 15.1-.3 15.9-.3 1.3-.1.9-1.3.9-1.6s-.3-1.6-.5-2.3c-1.6-7.8-3.4-14.8-4-16.9s-1.9-2-2.5-2.1c-1.6-.2-6.9-.4-9.4-.5" fill="var(--button-card-light-color-no-temperature)"/></svg>
            styles:
              custom_fields:
                icon_shade:
                  [top: 11%, left: 4.6%, width: 3.05vw, position: absolute]
            template: light

          #################################################
          #                                               #
          #                      TV                       #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: binary_sensor.tv
            triggers_update:
              ['binary_sensor.tv', 'input_boolean.sony_bravia_tv']
            style:
              top: 37.9%
              left: 30.31%
              width: 10%
            tap_action: !include popup/vardagsrum_tv.yaml
            hold_action: !include popup/vardagsrum_tv.yaml
            custom_fields:
              icon_tv: &icon_tv >
                [[[ var fill_color = entity.state === 'on' ? '#616161' : '#9da0a2';
                var gradient = entity.state === 'on' ? '<linearGradient id="A" gradientUnits="userSpaceOnUse" x1="5.401" y1="34.714" x2="43.817" y2="11.74"><stop offset="0" stop-color="#64acb7"/><stop offset="1" stop-color="#7fdbe9"/></linearGradient><path d="M2.9,8h44.3v29.9H2.9V8z" fill="url(#A)"/>' : ' '; 
                return '<svg viewBox="0 0 50 50">' + gradient + '<path d="M46 9.2v27.5H4.1V9.2H46m2.4-2.4H1.6v32.3h46.7c.1 0 .1-32.3.1-32.3zM11.9 43.2h26.3c.6 0 1.1-.4 1.1-1v-.3c0-.6-.4-1.1-1-1.1H11.9c-.6 0-1.1.4-1.1 1v.3a1.11 1.11 0 0 0 1.1 1.1z" fill="' + fill_color + '"/></svg>'; ]]]
              # loading: >
              #   [[[ var boolean = states['binary_sensor.tv'].state; 
              #   var invert = (entity.state === 'off') ? 'invert(1)' : 'none';
              #   var loader = '<img src="/local/gfx/loader.svg" width="100%" style="filter:' + invert + '">';
              #   if (boolean === 'on' && entity.state === 'off' || boolean === 'on' && entity.state === 'on') return loader; ]]]
            styles: &icon_tv_styles
              custom_fields:
                icon_tv:
                  [top: 7%, left: 10.7%, width: 3.5vw, position: absolute]
                loading: &loading
                  [top: 3%, left: 60%, width: 3.7vw, position: absolute, opacity: 0.5]
            template: switch

          #################################################
          #                                               #
          #                   SPISEBORD                   #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: light.kitchen_dimmer_2_level
            name: Spisebord
            style:
              top: 37.9%
              left: 41.31%
              width: 10%
            custom_fields:
              icon_spot: &icon_spot >
                <svg viewBox="0 0 50 50"><path d="M26.3 49.2s1.5.5 11-8.7c.5-.4 6.7-6.7 6.2-7.5-.7-.8-19.7-20.7-19.7-20.7s-.6-1-9.1 6.8c-.6.5-9.2 8.5-8.2 9.6l19.8 20.5z" fill="var(--button-card-light-color-no-temperature)"/><path d="M42.2.8H17.4c-.1 0-.1 0-.1.1a3.33 3.33 0 0 0 3.3 3.3h6.5c.1 0 .1 0 .1.1v7.9l3.6 3.7 1-1a2.84 2.84 0 0 0 .7-1.7v-9c0-.1 0-.1.1-.1H39c1.8.1 3.3-1.4 3.2-3.3h0z" fill="#9da0a2"/></svg>
            styles: &icon_spot_styles
              custom_fields:
                icon_spot:
                  [top: 11.5%, left: 8%, width: 2.7vw, position: absolute]
            template: light

          ##########################################################################
          #                                                                        #
          #                               * KONTOR *                               #
          #                                                                        #
          ##########################################################################

          - prefix: Kontor
            <<: *title
            style:
              top: 9.15%
              left: 49.65%
              <<: *title-style

          #################################################
          #                                               #
          #                   HUE IRIS                    #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: light.computer
            name: Hue Iris
            style:
              top: 20.35%
              left: 55.18%
              width: 10%
            custom_fields:
              icon_hue: *icon_hue
            styles: *icon_hue_styles
            template: light

          #################################################
          #                                               #
          #                   TAKLAMPE                    #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: light.kontoret_taklampe
            name: Taklampe
            style:
              top: 20.35%
              left: 66.14%
              width: 10%
            custom_fields:
              icon_spot: *icon_spot
            styles: *icon_spot_styles
            template: light

          #################################################
          #                                               #
          #                     DATOR                     #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: switch.wol_office_pc
            triggers_update:
              ['switch.wol_office_pc', 'input_boolean.pc', 'input_boolean.lock_computer']
            style:
              top: 37.9%
              left: 55.18%
              width: 10%
            tap_action:
              action: toggle
            hold_action: !include popup/pc.yaml
            custom_fields:
              icon_imac: >
                <svg viewBox="0 0 50 50"><path d="M31.9 44.5c-1-.3-1.9.4-1.9-3.7h-9.9c0 4.2-.9 3.4-1.9 3.7s-.2.7-.2.7h14.1s.8-.3-.2-.7zM47.6 4.8H2.5c-1.1 0-2 .9-2 2v30.1c0 1.1.9 2 2 2h45c1.1 0 2-.9 2-2v-30a1.95 1.95 0 0 0-1.9-2.1zm-.7 26.4H3.2V7.6H47v23.6z" /></svg>
              loading: >
                [[[ if (states['input_boolean.pc'].state === 'on') { 
                return '<img src="/local/gfx/loader.svg" width="100%">'; } ]]]
            styles:
              custom_fields:
                icon_imac:
                  [fill: "[[[ return entity.state === 'on' ? '#797a7b' : '#9da0a2'; ]]]", 
                  top: 8.5%, left: 11%, width: 3.3vw, position: absolute]
                loading: *loading
                icon_lock:
                  [top: 11%, left: 73%, width: 1.8vw, position: absolute, fill: '#9da0a2']
            template: switch

          #################################################
          #                                               #
          #                      FAN                      #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: fan.office
            name: Vifte
            style:
              top: 37.9%
              left: 66.14%
              width: 10%
            tap_action:
              action: toggle
            hold_action: !include popup/office_fan.yaml
            custom_fields:
              icon_fan: >
                [[[ if (entity.state === 'on') return '<img src="/local/gfx/fan.svg" />'; 
                else return '<svg viewBox="0 0 50 50" fill="#9ca2a5"><style>@keyframes spin{from{transform:rotate(0)}to{transform:rotate(720deg)}}.spin.animated{animation:spin 1.7s ease-out 1;transform-origin:center center}</style>
                <g class="spin animated"><circle cx="25" cy="25" r="6.6"/><path d="M31.9 30.4c-.5.6-1.1 1.1-1.7 1.5-1.4 1.1-3.2 1.7-5.2 1.7-2.3 0-4.5-.9-6-2.4-.9 1.1-1.6 2.3-2.3 3.2l-4.9 5.4c-1.8 2.7.3 5.6 2.5 7 3.9 2.4 9.8 3.1 14.1 1.9 4.6-1.3 7.9-4.7 7.4-9.7-.2-3.4-1.9-6-3.9-8.6zM17 28.3c-.4-1-.6-2.1-.6-3.3a8.7 8.7 0 0 1 6.4-8.4l-1.6-3.5L19 6.2c-1.5-2.8-5-2.5-7.3-1.2-4 2.2-7.5 6.9-8.7 11.3-1.2 4.6.2 9.2 4.7 11.3 3.1 1.3 6.1 1.2 9.3.7zm26.9-17.6c-3.3-3.4-8-4.6-12.1-1.8-2.8 1.8-4.2 4.6-5.5 7.5 4.2.6 7.4 4.2 7.4 8.6 0 .9-.1 1.7-.4 2.5 1.3.2 2.8.3 3.8.4 2.3.4 4.7 1.3 7.1 1.7 3.2.3 4.7-3 4.8-5.6.3-4.6-1.9-10.1-5.1-13.3z"/></g></svg>'; ]]]
            styles:
              custom_fields:
                icon_fan:
                  [top: 9%, left: 10%, width: 3vw, position: absolute]
            template: switch


          ##########################################################################
          #                                                                        #
          #                               * SOVRUM *                               #
          #                                                                        #
          ##########################################################################

          - prefix: Soverom
            <<: *title
            style:
              top: 9.15%
              left: 74.55%
              <<: *title-style

          #################################################
          #                                               #
          #                 MATTIAS LIGHT                 #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: light.bedroom
            name: Taklampe
            style:
              top: 20.35%
              left: 80.05%
              width: 10%
            custom_fields:
              icon_spot: *icon_spot
            styles: *icon_spot_styles
            template: light

          #################################################
          #                                               #
          #                  SANJA LIGHT                  #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: light.nightstand_person1
            name: Nattbord
            style:
              top: 20.35%
              left: 91.05%
              width: 10%
            custom_fields:
              icon_lamp: &icon_lamp >
                <svg viewBox="0 0 50 50"><path d="M26.5 21.8l3.8-6.1H19.7l3.8 6.1c-5 .7-6.3 5.8-5.7 10.2.7 5.1 3.2 10.1 5.7 14.4H19v2.5h11.8v-2.5h-4.5C29 42 31.4 37 32.1 32c.6-4.4-.6-9.4-5.6-10.2zm3.1 9.1c-.3 4.3-2.3 8.7-4.4 12.4l-.2.1v.1-.1c-1.8-3-3.3-6.4-4.1-9.7-.7-3.1-1-7.2 2.7-8.4 1.4-.5 3.1-.1 4.2.8 1.6 1 1.8 3 1.8 4.8z" fill="#9da0a2"/><path d="M38.1 20L35.7 3.8c-.3-1.9-.4-1.7-.6-2-.9-.6-2.3-.7-2.3-.7H17.4s-1.4 0-2.3.7c-.2.3-.3.1-.6 2C14 5.7 11.9 20 11.9 20s5.8.3 13.4.3h0c7.3 0 12.8-.3 12.8-.3z" fill="var(--button-card-light-color-no-temperature)"/></svg>
            styles: &icon_lamp_styles
              custom_fields:
                icon_lamp:
                  [top: 11%, left: 4.5%, width: 3.05vw, position: absolute]
            template: light

          #################################################
          #                                               #
          #                      FAN                      #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: fan.bedroom
            name: Vifte
            style:
              top: 37.9%
              left: 80.05%
              width: 10%
            tap_action:
              action: toggle
            hold_action: !include popup/bedroom_fan.yaml
            custom_fields:
              icon_fan: >
                [[[ if (entity.state === 'on') return '<img src="/local/gfx/fan.svg" />'; 
                else return '<svg viewBox="0 0 50 50" fill="#9ca2a5"><style>@keyframes spin{from{transform:rotate(0)}to{transform:rotate(720deg)}}.spin.animated{animation:spin 1.7s ease-out 1;transform-origin:center center}</style>
                <g class="spin animated"><circle cx="25" cy="25" r="6.6"/><path d="M31.9 30.4c-.5.6-1.1 1.1-1.7 1.5-1.4 1.1-3.2 1.7-5.2 1.7-2.3 0-4.5-.9-6-2.4-.9 1.1-1.6 2.3-2.3 3.2l-4.9 5.4c-1.8 2.7.3 5.6 2.5 7 3.9 2.4 9.8 3.1 14.1 1.9 4.6-1.3 7.9-4.7 7.4-9.7-.2-3.4-1.9-6-3.9-8.6zM17 28.3c-.4-1-.6-2.1-.6-3.3a8.7 8.7 0 0 1 6.4-8.4l-1.6-3.5L19 6.2c-1.5-2.8-5-2.5-7.3-1.2-4 2.2-7.5 6.9-8.7 11.3-1.2 4.6.2 9.2 4.7 11.3 3.1 1.3 6.1 1.2 9.3.7zm26.9-17.6c-3.3-3.4-8-4.6-12.1-1.8-2.8 1.8-4.2 4.6-5.5 7.5 4.2.6 7.4 4.2 7.4 8.6 0 .9-.1 1.7-.4 2.5 1.3.2 2.8.3 3.8.4 2.3.4 4.7 1.3 7.1 1.7 3.2.3 4.7-3 4.8-5.6.3-4.6-1.9-10.1-5.1-13.3z"/></g></svg>'; ]]]
            styles:
              custom_fields:
                icon_fan:
                  [top: 9%, left: 10%, width: 3vw, position: absolute]
            template: switch

          #################################################
          #                                               #
          #                      TV2                      #
          #                                               #
          #################################################

          # - type: custom:button-card
          #   entity: media_player.samsung
          #   triggers_update:
          #     ['media_player.samsung', 'input_boolean.samsung']
          #   style:
          #     top: 37.9%
          #     left: 91.05%
          #     width: 10%
          #   tap_action:
          #     services: |
          #       [[[ if (entity.state === 'off') 
          #       hass.callService('input_boolean', 'turn_on', {entity_id: 'input_boolean.samsung'});
          #       hass.callService('remote', 'send_command', {entity_id: 'remote.sovrum', command: 'menu'}); 
          #       if (entity.state === 'on') 
          #       hass.callService('input_boolean', 'turn_on', {entity_id: 'input_boolean.samsung'}); 
          #       hass.callService('media_player', 'turn_off', {entity_id: 'media_player.samsung'}); ]]]
          #   hold_action: !include popup/sovrum_tv2.yaml
          #   custom_fields:
          #     icon_tv: *icon_tv
          #     loading: >
          #       [[[ var boolean = states['input_boolean.samsung'].state; 
          #       var invert = (entity.state === 'off') ? 'invert(1)' : 'none';
          #       var loader = '<img src="/local/gfx/loader.svg" width="100%" style="filter:' + invert + '">';
          #       if (boolean === 'on' && entity.state === 'off' || boolean === 'on' && entity.state === 'on') return loader; ]]]
          #   styles: *icon_tv_styles
          #   template: switch

          ##########################################################################
          #                                                                        #
          #                               * MEDIA *                                #
          #                                                                        #
          ##########################################################################
 
          - prefix: Media
            <<: *title
            style:
              top: 53.4%
              left: 24.75%
              <<: *title-style

          - type: custom:swipe-card
            start_card: 1
            parameters:
              effect: coverflow
              speed: 650
              spaceBetween: 20
              threshold: 7
              coverflowEffect:
                rotate: 80
                depth: 300
            style:
              top: 56.55%
              left: 35.8%
              width: 20.97%
              height: 1px
              --ha-card-background: none
              --ha-card-border-radius: .88vw
              --ha-card-box-shadow: none
              image-rendering: crisp-edges
            cards:

            - type: picture-elements
              image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50' /%3E"
              elements:

                ################################################
                #                                              #
                #             RECENTLY DOWNLOADED              #
                #                                              #
                ################################################

                - type: conditional
                  conditions:
                    - entity: input_select.conditional_media
                      state: Siste fra Plex
                  elements:
                    - type: custom:button-card
                      entity: sensor.placeholder
                      triggers_update:
                        ['sensor.plex_title', 'sensor.plex_poster']
                      name: Siste fra Plex
                      state_display: >
                        [[[ return states['sensor.plex_title'].state; ]]]
                      custom_fields:
                        icon: >
                          <svg viewBox="0 0 50 50"><path d="M7.7.3h34.6c4.1 0 7.4 3.3 7.4 7.4v34.6c0 4.1-3.3 7.4-7.4 7.4H7.7c-4.1 0-7.4-3.3-7.4-7.4V7.7C.3 3.6 3.6.3 7.7.3z" fill="#282a2d"/><path d="M25,7.1H14.6L25,25L14.6,42.9H25L35.4,25L25,7.1z" fill="#e5a00d"/></svg>
                        blur: >
                          <svg viewBox="0 0 50 50" />
                      styles:
                        custom_fields:
                          media_image: &plex_poster
                            [background-position: center center, background-image: 
                            "[[[ return 'url(' + states['sensor.plex_poster'].state + ')'; ]]]"]
                          blur: *plex_poster
                          overlay: [background: 'rgba(0, 0, 0, 0.4)']
                        card:
                          [color: '#efefef', text-shadow: '1px 1px 5px rgba(18, 22, 23, 0.9)']
                      tap_action:
                        action: none
                      style:
                        top: 50%
                        left: 50%
                        width: 100%
                      template: media

                #################################################
                #                                               #
                #              APPLE TV VARDAGSRUM              #
                #                                               #
                #################################################

                - type: conditional
                  conditions:
                    - entity: input_select.conditional_media
                      state: TV
                  elements:
                    - type: custom:button-card
                      entity: media_player.stue_2
                      custom_fields:
                        icon: &icon_apple_tv >
                          <svg viewBox="0 0 50 50"><path d="M25.2 49.7l-13.7-.1c-2.4 0-4.6-.8-6.5-2.2-2-1.6-3.6-3.6-4.3-6.2-.2-1-.2-1.9-.3-3V11.5C.5 7.9 1.9 5 4.8 2.7 6.2 1.6 7.8.8 9.6.5c.5-.1.9-.1 1.4-.1L27.5.3l10.9.1c2.6 0 4.8.8 6.7 2.4 2.1 1.7 3.7 3.9 4.2 6.6l.2 2.4.1 20.5-.1 6.7c-.1 2.2-.9 4.2-2.2 5.9-1.7 2.2-4 3.8-6.8 4.4-.6.1-1.2.2-1.9.2-.1.1-13.4.2-13.4.2zm-4-27.8c-.9-1.2-2.2-1.6-3.7-1.2-.4.1-.8.2-1.2.4-.3.1-.6.1-.8 0-.4-.1-.8-.3-1.2-.4-.3-.1-.7-.1-1-.1-1.5.2-2.4 1.1-3 2.6-.4 1.1-.3 2.2 0 3.5.4 1.5 1 2.9 2.1 4 .5.6 1.2.9 2 .6 1.1-.5 2.2-.5 3.4 0 .8.3 1.5 0 2.1-.6.7-.8 1.1-1.8 1.6-2.8v-.2c-1-.6-1.7-1.4-1.8-2.7-.2-1.4.5-2.4 1.5-3.1zm9.9-1.4c.1.2.1.3.1.4l3.6 9.5c.1.3.3.4.6.4h.7c.6 0 .6 0 .9-.6l3.7-9.4c.1-.1.1-.3.2-.5H39l-2.9 8.3-3.1-8.3-1.9.2zM27.3 18l-1.3.4c-.5.2-.5.2-.6.7v1.4h-1.6l.1 1.4h1.5v5c0 .7.1 1.4.2 2.1.1.5.3 1 .8 1.4.8.6 2.6.7 3.5.2l-.1-1.2h-1.3c-.5 0-.9-.3-1-.8-.1-.3-.2-.6-.2-1v-5.8H30c0-.5.1-1 0-1.4h-2.7V18zm-8.8-.9c-1.9.3-3 2-2.7 3.2 1.4.2 2.9-1.7 2.7-3.2z"/></svg>
                      style:
                        top: 50%
                        left: 50%
                        width: 100%
                      template: media

                #################################################
                #                                               #
                #                APPLE TV SOVRUM                #
                #                                               #
                #################################################

                - type: conditional
                  conditions:
                    - entity: input_select.conditional_media
                      state: Kjøkken
                  elements:
                    - type: custom:button-card
                      entity: media_player.kjkken
                      custom_fields:
                        icon: *icon_apple_tv
                      style:
                        top: 50%
                        left: 50%
                        width: 100%
                      template: media

                #################################################
                #                                               #
                #                 PLAYSTATION 4                 #
                #                                               #
                #################################################

                - type: conditional
                  conditions:
                    - entity: input_select.conditional_media
                      state: Bad
                  elements:
                    - type: custom:button-card
                      entity: media_player.bad
                      custom_fields:
                        icon: &sonos >
                          <svg viewBox="0 0 50 50"><path d="M25.2,49.6l-13.65-.1a10.81,10.81,0,0,1-6.47-2.19A11.86,11.86,0,0,1,.8,41.13a27.31,27.31,0,0,1-.3-3V11.55A11,11,0,0,1,4.88,2.79,10.63,10.63,0,0,1,9.66.6a6.6,6.6,0,0,1,1.4-.1L27.49.4,38.35.5A10,10,0,0,1,45,2.89,11.11,11.11,0,0,1,49.2,9.46l.2,2.39.1,20.42-.1,6.67a10.42,10.42,0,0,1-2.19,5.88,11.58,11.58,0,0,1-6.77,4.38,11.08,11.08,0,0,1-1.9.2C38.45,49.5,25.2,49.6,25.2,49.6Zm2.23-23.94-5.27-4.94V29h1.57v-4.6L29,29.36V21.05H27.43ZM15.2,20.61A4.31,4.31,0,0,0,10.82,25a4.46,4.46,0,0,0,4.38,4.38,4.38,4.38,0,1,0,0-8.75m0,7.18A2.81,2.81,0,1,1,18,25a2.78,2.78,0,0,1-2.81,2.81M8.13,25a5.45,5.45,0,0,0-1.79-.78c-1.57-.45-1.57-.9-1.57-1.13,0-.44.56-.89,1.34-.89a3,3,0,0,1,1.46.45l.11.11,1.24-.9-.11-.11a3.86,3.86,0,0,0-2.7-1.12A3.45,3.45,0,0,0,4,21.28a2.24,2.24,0,0,0,0,3.59,5.42,5.42,0,0,0,1.8.79c1.57.44,1.57.89,1.57,1.12,0,.45-.56.9-1.35.9a3.24,3.24,0,0,1-1.46-.45l-.11-.12L3.19,28l.12.11A3.84,3.84,0,0,0,6,29.25a3.43,3.43,0,0,0,2.13-.68A2.34,2.34,0,0,0,9,26.78a2.53,2.53,0,0,0-.9-1.8M36,20.61A4.3,4.3,0,0,0,31.59,25,4.38,4.38,0,0,0,36,29.36,4.32,4.32,0,0,0,40.34,25,4.38,4.38,0,0,0,36,20.61m0,7.18A2.81,2.81,0,1,1,38.77,25,2.86,2.86,0,0,1,36,27.79M43,24.87a5.42,5.42,0,0,0,1.8.79c1.57.44,1.57.89,1.57,1.12,0,.45-.56.9-1.35.9a3.24,3.24,0,0,1-1.46-.45h-.11l-1.23.89.11.12a3.85,3.85,0,0,0,2.69,1.12,3.49,3.49,0,0,0,2.13-.67,2.25,2.25,0,0,0,0-3.6,5.36,5.36,0,0,0-1.79-.78c-1.57-.45-1.57-.9-1.57-1.12,0-.45.56-.9,1.34-.9a3.15,3.15,0,0,1,1.46.45l.12.11L48,22l-.11-.11a3.86,3.86,0,0,0-2.7-1.12,3.45,3.45,0,0,0-2.13.67,2.35,2.35,0,0,0-.9,1.8,1.67,1.67,0,0,0,.9,1.68" transform="translate(-0.5 -0.4)"/></svg>
                      style:
                        top: 50%
                        left: 50%
                        width: 100%
                      template: media

                #################################################
                #                                               #
                #               GOOGLE NEST MINI                #
                #                                               #
                #################################################

                - type: conditional
                  conditions:
                    - entity: input_select.conditional_media
                      state: Kontor
                  elements:
                    - type: custom:button-card
                      entity: media_player.kontor
                      custom_fields:
                        icon: &icon_nest_mini >
                          <svg viewBox="0 0 50 50"><path d="M49.7 25c0 13.6-11.1 24.7-24.8 24.7C11.3 49.7.3 38.6.3 25S11.4.3 25 .3 49.7 11.4 49.7 25zm-33.9 0a2.22 2.22 0 0 0-2.2-2.2c-1.2 0-2.3 1-2.3 2.2a2.22 2.22 0 0 0 2.2 2.2c1.3.1 2.3-.9 2.3-2.2h0zm10.8 0c0 1.2.9 2.2 2.2 2.3 1.3 0 2.3-1 2.3-2.2 0-1.3-1-2.3-2.2-2.3-1.3 0-2.3.9-2.3 2.2zm-3.2 0a2.22 2.22 0 0 0-2.2-2.2c-1.2 0-2.3 1-2.3 2.2a2.22 2.22 0 0 0 2.2 2.2c1.3 0 2.3-.9 2.3-2.2h0zm13 2.2a2.22 2.22 0 0 0 2.2-2.2c0-1.2-1-2.3-2.2-2.3a2.22 2.22 0 0 0-2.2 2.2c0 1.3 1 2.3 2.2 2.3z" /></svg>
                      style:
                        top: 50%
                        left: 50%
                        width: 100%
                      template: media

                #################################################
                #                                               #
                #           * SMALL MEDIA CONTROLS *            #
                #                                               #
                #################################################

            - type: picture-elements
              image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' /%3E"
              elements:

                # SMALL APPLE TV VARDAGSRUM
                - type: custom:button-card
                  entity: media_player.stue_2
                  name: Stue
                  custom_fields:
                    icon: *icon_apple_tv
                  style:
                    top: 23.9%
                    left: 23.8%
                    width: 47.7%
                  template: media_small

                # SMALL APPLE TV SOVRUM
                - type: custom:button-card
                  entity: media_player.kjkken
                  name: Sonos Kjøkken
                  custom_fields:
                    icon: *sonos
                  style:
                    top: 23.9%
                    left: 76.2%
                    width: 47.7%
                  template: media_small

                # SMALL PLAYSTATION 4
                - type: custom:button-card
                  entity: media_player.bad
                  name: Sonos Bad
                  custom_fields:
                    icon: *sonos
                  style:
                    top: 76.2%
                    left: 23.8%
                    width: 47.7%
                  template: media_small

                # SMALL GOOGLE NEST MINI
                - type: custom:button-card
                  entity: media_player.kontor
                  name: Sonos Kontor
                  custom_fields:
                    icon: *sonos
                  style:
                    top: 76.2%
                    left: 76.2%
                    width: 47.7%
                  template: media_small

          ##########################################################################
          #                                                                        #
          #                               * LAMPOR *                               #
          #                                                                        #
          ##########################################################################

          - prefix: Lys
            <<: *title
            style:
              top: 53.4%
              left: 49.6%
              <<: *title-style

          #################################################
          #                                               #
          #                    BADRUM                     #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: light.bathroom
            name: Bad
            style:
              top: 64.5%
              left: 55.18%
              width: 10%
            custom_fields:
              icon_bathroom: >
                [[[ const state = entity.state==='on' ? 'animate_on' : 'animate_off'; 
                return `<svg viewBox="0 0 50 50" fill="var(--button-card-light-color-no-temperature)"><style>@keyframes animate_on{0%{transform: rotateZ(0deg) translate(0%, 0%);}100%{transform: rotateZ(-90deg) translate(-1.5%, 0%);}}@keyframes animate_off{0%{transform: rotateZ(-90deg) translate(-1.5%, 0%);}45%{transform: rotateZ(-40deg);}55%{transform: rotateZ(0deg);}65%{transform: rotateZ(-15deg);}75%{transform: rotateZ(0deg);}85%{transform: rotateZ(-5deg);}95%{transform: rotateZ(0deg);}}.animate_on{animation: animate_on 0.4s; animation-fill-mode: forwards; transform-origin: 45% 41%; transition-timing-function: cubic-bezier(0.85, 0, 0.15, 1);}.animate_off{animation: animate_off 1.05s linear; animation-delay: 0.05s; animation-fill-mode: both; transform-origin: 45% 41%;}</style>
                <path d="M12.9 1.2h2.5c1.6 0 2.9 1.3 2.9 2.9v18.6c0 1.4 1.1 2.5 2.4 2.5h20.5c.5 0 1 .4.9 1-.1 2.6-1.2 9.6-10.2 11v7.6c0 .2.2.4.4.4h1.5a1.58 1.58 0 0 1 1.6 1.6v.3a1.58 1.58 0 0 1-1.6 1.6H11a1.58 1.58 0 0 1-1.6-1.6v-.3a1.58 1.58 0 0 1 1.6-1.6h1.6c.2 0 .4-.2.4-.4v-7.6s-5.2-.3-5.2-5.9V4.2c0-1.6 1.3-2.9 2.9-2.9l2.2-.1c0 .1 0 0 0 0z"/><path class="${state}" d="M22.3 18.8h18.3a1.58 1.58 0 0 1 1.6 1.6v.6a1.58 1.58 0 0 1-1.6 1.6h-19c-.4 0-.7-.3-.8-.7v-2.3c0-.4.3-.7.7-.8h.8z"/></svg>`;]]]
            styles:
              custom_fields:
                icon_bathroom:
                  [top: 11%, left: 6.5%, width: 3vw, position: absolute]
            template: light

          #################################################
          #                                               #
          #                      KÖK                      #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: light.kitchen
            name: Kjøkken
            style:
              top: 64.5%
              left: 66.14%
              width: 10%
            custom_fields:
              icon_kitchen: >
                <svg viewBox="0 0 50 50"><path d="M13.3 37.1V29c0-.3 0-.5.1-.8.1-.2.3-.4.5-.6.4-.4.8-.7 1-1.1.1-.3.1-.6.1-.9V23c0-.3 0-.6-.1-.9-.1-.5-.4-.9-.7-1.2s-.6-.5-.9-.7c-.7-.5-1.2-1-1.7-1.5-1-1.2-1.6-2.9-1.6-4.4v-10c0-2.2 3.4-2.1 3.4.1v8.5c0 .4.2.7.6.8s.7 0 1-.4V4.4c0-2.2 3.4-2.2 3.4 0V13c0 .4.3.7.6.8.4.1.8-.1 1-.4.1-.1.1-.3.1-.4V4.5a1.69 1.69 0 0 1 .3-1c.9-1.4 3.1-.6 3.1 1v9.9c0 .4 0 .8-.1 1.2-.2 1-.6 1.9-1.2 2.8-.5.7-1.1 1.2-1.8 1.7-.2.1-.3.2-.5.3-.5.4-.9.9-1.2 1.4-.2.4-.3.8-.2 1.2v3c0 .5.2.9.5 1.2l.6.6c.2.2.3.3.4.6s.2.6.2.9v16c0 1.9-1.5 3.7-3.6 3.6s-3.2-1.8-3.2-3.7c0 .2-.1-8.1-.1-8.1zM40 24.8v20.3c0 1.9-1.5 3.7-3.6 3.6-1.8-.1-3.3-1.7-3.3-3.6V26.6c0-.7-.4-1.2-1-1.6-.2-.1-.4-.2-.6-.2s-.4 0-.6-.1c-.4-.1-.7-.4-.8-.7s-.2-.5-.2-.8V12.7c0-3.8.8-9.7 4.8-11.3 2.7-1.1 5.4.3 5.4 3.4 0-.1-.1 20-.1 20z" fill="var(--button-card-light-color-no-temperature)"/></svg>
            styles:
              custom_fields:
                icon_kitchen:
                  [top: 11%, left: 6%, width: 3vw, position: absolute]
            template: light

          #################################################
          #                                               #
          #                   GARDEROB                    #
          #                                               #
          #################################################

          # - type: custom:button-card
          #   entity: light.kladkammare_2
          #   style:
          #     top: 82.1%
          #     left: 55.18%
          #     width: 10%
            # custom_fields:
            #   icon_closet: >
            #     [[[ const state = entity.state==='on' ? 'animate_on' : 'animate_off'; 
            #     return `<svg viewBox="0 0 50 50" fill="var(--button-card-light-color-no-temperature)"><style>@keyframes animate_on{0%{transform: rotateZ(0deg) translate(0%, 0%);}100%{transform: rotateZ(-90deg) translate(-1.5%, 0%);}}@keyframes animate_off{0%{transform: rotateZ(-90deg) translate(-1.5%, 0%);}45%{transform: rotateZ(-40deg);}55%{transform: rotateZ(0deg);}65%{transform: rotateZ(-15deg);}75%{transform: rotateZ(0deg);}85%{transform: rotateZ(-5deg);}95%{transform: rotateZ(0deg);}}.animate_on{animation: animate_on 0.4s; animation-fill-mode: forwards; transform-origin: 45% 41%; transition-timing-function: cubic-bezier(0.85, 0, 0.15, 1);}.animate_off{animation: animate_off 1.05s linear; animation-delay: 0.05s; animation-fill-mode: both; transform-origin: 45% 41%;}</style>
            #     <path d="M12.9 1.2h2.5c1.6 0 2.9 1.3 2.9 2.9v18.6c0 1.4 1.1 2.5 2.4 2.5h20.5c.5 0 1 .4.9 1-.1 2.6-1.2 9.6-10.2 11v7.6c0 .2.2.4.4.4h1.5a1.58 1.58 0 0 1 1.6 1.6v.3a1.58 1.58 0 0 1-1.6 1.6H11a1.58 1.58 0 0 1-1.6-1.6v-.3a1.58 1.58 0 0 1 1.6-1.6h1.6c.2 0 .4-.2.4-.4v-7.6s-5.2-.3-5.2-5.9V4.2c0-1.6 1.3-2.9 2.9-2.9l2.2-.1c0 .1 0 0 0 0z"/><path class="${state}" d="M22.3 18.8h18.3a1.58 1.58 0 0 1 1.6 1.6v.6a1.58 1.58 0 0 1-1.6 1.6h-19c-.4 0-.7-.3-.8-.7v-2.3c0-.4.3-.7.7-.8h.8z"/></svg>`;]]]
            # styles:
            #   custom_fields:
          #       icon_closet:
          #         [top: 11%, left: 4.1%, width: 3.2vw, position: absolute]
          #   template: light

          #################################################
          #                                               #
          #                     HALL                      #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: light.gang
            style:
              top: 82.1%
              left: 66.14%
              width: 10%
            custom_fields:
              icon_spot: *icon_spot
            styles: *icon_spot_styles
            template: light

          ##########################################################################
          #                                                                        #
          #                               * HEMMA *                                #
          #                                                                        #
          ##########################################################################

          - prefix: Hjemme
            <<: *title
            style:
              top: 53.4%
              left: 74.5%
              <<: *title-style

          #################################################
          #                                               #
          #                    THOMAS                     #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: person.person1
            triggers_update:
              ['person.person1', 'sensor.person1_last_changed']
            state_display: &button_home_state_display >
              [[[ return entity.state == 'home' ? 'Ja' : 'Nej'; ]]]
            show_entity_picture: true
            state: &button_home_state
              - value: 'home'
                styles:
                  card:
                    - background-color: rgba(255, 255, 255, 0.8)
                  name:
                    - color: rgba(0, 0, 0, 0.6)
                  state:
                    - color: rgba(0, 0, 0, 0.6)
                  custom_fields:
                    info:
                      - color: '#959698'
            styles: &button_home_styles
              entity_picture:
                  [clip-path: circle(50% at center), top: 7.5%, left: 11.2%, width: 3vw, position: absolute]
              custom_fields:
                sensor: *circle_pos
            style:
              top: 64.5%
              left: 80.05%
              width: 10%
            tap_action: !include popup/hjemme_person1.yaml
            hold_action: !include popup/hjemme_person1.yaml
            custom_fields:
              sensor: >
                [[[ var last_changed = states['sensor.person1_last_changed'].state; 
                var home = (entity.state === 'home'); 
                var stroke_color = home ? '#b2b2b2' : '#313638'; 
                var fill_color = home ? 'none' : '#FFFFFF08';
                return '<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20.5" stroke="' + stroke_color+ '" stroke-width="1.5" fill="' + fill_color + '" /><text x="50%" y="54%" fill="#8d8e90" font-size="14" text-anchor="middle" alignment-baseline="middle">' + last_changed + '</text></svg>'; ]]]
            template: switch

          #################################################
          #                                               #
          #                      MON                      #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: person.person2
            triggers_update:
              ['person.person2', 'sensor.person2_last_changed']
            state_display: *button_home_state_display
            show_entity_picture: true
            state: *button_home_state
            styles: *button_home_styles
            style:
              top: 64.5%
              left: 91.05%
              width: 10%
            tap_action: !include popup/hjemme_person2.yaml
            hold_action: !include popup/hjemme_person2.yaml
            custom_fields:
              sensor: >
                [[[ var last_changed = states['sensor.person2_last_changed'].state; 
                var home = (entity.state === 'home'); 
                var stroke_color = home ? '#b2b2b2' : '#313638'; 
                var fill_color = home ? 'none' : '#FFFFFF08';
                return '<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20.5" stroke="' + stroke_color+ '" stroke-width="1.5" fill="' + fill_color + '" /><text x="50%" y="54%" fill="#8d8e90" font-size="14" text-anchor="middle" alignment-baseline="middle">' + last_changed + '</text></svg>'; ]]]
            template: switch

          #################################################
          #                                               #
          #                  STÄNG ALLT                   #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: switch.auto_turn_off
            state_display: Auto
            style:
              top: 82.1%
              left: 80.05%
              width: 10%
            tap_action:
              action: toggle
            hold_action:
              action: none
            custom_fields:
              icon_away: >
                [[[ const state=entity.state==='on' ? 'animate' : null;
                return `<svg viewBox="0 0 50 50"><style>@keyframes animate{10%, 20%, 100%{transform: rotateZ(0deg);}30%, 50%, 70%{transform: rotateZ(7deg);}90%{transform: rotateZ(3deg);}40%, 60%, 80%{transform: rotateZ(-7deg);}}.animate{animation: animate 1.35s cubic-bezier(0.5, 1, 0.89, 1); animation-fill-mode: both; transform-origin: 70% 80%; animation-delay: 0s;}</style>
                <path class="${state}" d="M32.1 18.4s.3-1.6.7-2.1c.3-.6.9-1.4 1.6-1.8.6-.4 1.1-.7 1.4-.7s.7-.1 1 .1.6.4.8 1.3l.3 2.7.1 2.4.2 4.1c0 .3.2 3.1.2 3.3s.2 2.7.2 3.2l-.1 2.5c.1 1.6.5 3.1-.2 4.6-.6 1.4-1.7 2.7-2.9 3.6-.5.4-1.9 1.3-2.9 1.7-1.1.5-2.2.8-3.3 1.1-.5.1-1.4.4-2.3.3s-1.8-.6-2.1-1l-1.6-2.3c-.6-.8-2.1-2.3-2.3-2.5l-2.7-2.8c-.2-.2-2.7-3.5-2.9-3.8l-3.1-4.7-1.8-3.2-1.5-2.8-.9-1.8c-.1-.2-.3-1.1-.2-1.4.3-1.2 1.4-1.4 2.3-.7.3.2.9 1 1.1 1.3s6.1 8.1 6.1 8.1c.2.3.7.3.9 0s-.1-.7-.2-.9c-.4-.6-8.3-11.5-8.3-11.5s-.6-.9-.7-1.1c-.3-1.1 0-2.3 1.1-2.7s1.9.3 2.6 1.1c.3.3 8.3 11.5 8.3 11.5.2.2.3.3.5.3.3 0 .5-.4.4-.7-.1-.2-.5-.9-.5-.9L11.8 9c-.6-1-.9-2-.1-3 .7-.8 2.2-1.3 3-.2.3.3 10.1 14.3 10.1 14.3.2.2.5.4.7.3.5-.1.3-.7.1-1-.1-.2-8.4-11.8-8.4-11.8-.4-.9-.6-2 .2-2.8 1-1.1 2.5-.5 3.3.5.2.3 1 1.4 1 1.4l2.7 3.7c.1.2 3.4 4.4 3.8 4.8.9 1.1 1.8 2.2 2.7 3.2l.5.5c.1.1.1.4.1.8 0 1.3.1 2.6.1 3.9 0 .2.1.4.2.6.3.3.6.1.7-.2.1-.2 0-2.4 0-2.7-.3-.3-.5-1.3-.4-2.9zM12.2 46.9s-2.8-.8-4.8-2.7-2.6-2.7-2.8-3-1.8-3-2-3.6c-.2-.5-.2-.7.2-1 .4-.4 1-.5 1.3.1.1.2.4 1 .5 1.2s1 1.9 1.7 2.8 1.6 2.2 4.4 3.8c.6.3 1.2.6 1.9.9.3.1.6.2.8.4.1.2.1.6-.1.8-.2.4-.7.4-1.1.3zM7.1 30.7l.9 3.1c.3.7 1.1 2.3 1.9 3.3s2.4 2.6 3.4 3.2 2 1.1 3 1.5c1 .3 1.1.4 1.2.5.3.4.2 1.2-.4 1.3-.2 0-1.2 0-1.8-.3L12 41.7c-.5-.4-3.9-3.1-5.1-6S5.3 31 5.2 30.4s-.2-1.1 0-1.4c.3-.4.9-.8 1.3-.3.2.3.3.6.3.9.1 0 .2.8.3 1.1zm26.8-25s.2-.1.5-.1.8.3 1.4.7 1.9 1 3.6 2.9 2.9 3.9 3.4 5.8c.5 1.8.8 3.1.9 5.5 0 .5.1 1.6 0 1.7-.2.5-.5.7-1 .7-.6 0-.7-.5-.7-1l-.1-2.9c-.1-.6-.3-1.9-.7-2.9-.3-1-.7-2.3-1.7-3.6-.9-1.3-2.1-2.8-3.2-3.5l-2.4-1.5c-.6-.6-.7-1.2 0-1.8zm4.9-2.5s.3-.2.5-.1c.2 0 .7.3.9.4s2.1 1.3 3.6 3c1.5 1.6 3.5 5.1 3.7 7.4.1.4.2.9 0 1-.2.2-.4.4-.7.4-.2 0-.5 0-.7-.1-.1-.2-.4-1.1-.4-1.3s-.6-2-1.1-3.1C44 9.7 43.5 8.5 42 7.1s-2.2-1.9-2.8-2.2-1.1-.6-1.1-1c.1-.3.3-.6.7-.7z"/></svg>`; ]]]
            styles:
              card: [transition: all 0.3s ease-out]
              custom_fields:
                icon_away:
                  [top: 10%, left: 10.1%, width: 3.1vw, position: absolute,
                  fill: "[[[ return entity.state === 'on' ? '#516d82' : '#9da0a2'; ]]]"]
            template: switch

          #################################################
          #                                               #
          #                     HEMMA                     #
          #                                               #
          #################################################

          - type: custom:button-card
            entity: sensor.house_mode
            # state_display: Auto
            name: Modus
            style:
              top: 82.1%
              left: 91.05%
              width: 10%
            tap_action:
              action: toggle
            hold_action: !include popup/hemma_data_kwh.yaml
            custom_fields:
              icon_home: >
                [[[ const state = entity.state === 'on' ? 'animate' : null;
                return `<svg viewBox="0 0 50 50"> <style>@keyframes animate{from, 20%, 40%, 60%, 80%, to{animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);}0%{transform: scale(0.3);}20%{transform: scale(1.1);}40%{transform: scale(0.9);}60%{transform: scale(1.03);}80%{transform: scale(0.97);}to{transform: scale(1);}}.animate{animation: animate 1s; transform-origin: center;}</style>
                <path class="${state}" d="M42.2 28.3c0-.8-.2-1-.2-1L26 12.1s-.5-.4-1-.4-1 .3-1 .3L8.2 27.1c-.4.5-.4.9-.4.9v18.3c0 1.1.9 2 1.9 2h8.2a1.47 1.47 0 0 0 1.5-1.5v-14a1.47 1.47 0 0 1 1.5-1.5h8.4a1.47 1.47 0 0 1 1.5 1.5v14a1.47 1.47 0 0 0 1.5 1.5h8.2c1.1 0 2-.9 2-1.9 0-.2-.3-18.1-.3-18.1zM7.3 25l-1.6 1.5s-.3.3-.5.3-.5 0-.8-.2c-.2-.2-2-2.8-2-2.8s-.1-.4-.1-.7c.1-.3.2-.7.3-.8.4-.1 21.5-20.1 21.5-20.1s.4-.3.9-.3c.4 0 .8.1.9.2s.5.4.5.4l8.9 8.5V6s.1-.4.2-.7c.1-.2.3-.3.4-.3s.3-.1.3-.1h3s.3.1.4.3a1.08 1.08 0 0 1 .3.7v9.8l7.2 6.9s.2.3.3.4c.1.2.1.7.1.7 0 .1-.1.4-.2.5s-1.6 2.5-1.6 2.5-.1.3-.3.3c-.2.1-.4.1-.7 0-.2-.1-.5-.4-.5-.4L26.4 9.4s-.3-.3-.5-.4-.4-.2-.8-.2-.5.1-.8.1c-.1.1-.4.3-.7.5C23.3 9.8 7.3 25 7.3 25z"/></svg>`; ]]]
            styles:
              card: [transition: all 0.3s ease-out]
              custom_fields:
                icon_home:
                  [top: 10.5%, left: 10.1%, width: 2.9vw, position: absolute,
                  fill: "[[[ return entity.state === 'on' ? '#c7983e' : '#9da0a2'; ]]]"]
            template: switch

          #################################################
          #                                               #
          #                RELOAD LOVELACE                #
          #                                               #
          #################################################

          - type: icon
            title: Reload
            icon: mdi:dots-vertical
            style:
              top: 4%
              left: 98%
              color: rgba(255, 255, 255, 0.1)
              opacity: 0.5
              padding: 1vw
              --mdc-icon-size: 4vw
            tap_action:
              action: call-service
              service: browser_mod.lovelace_reload
